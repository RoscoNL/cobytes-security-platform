# Complete PentestTools.com API Integration Guide

## API Overview

### Base Information
- **Base URL**: `https://app.pentest-tools.com/api/v2`
- **Authentication**: Bearer token (API Key)
- **Documentation**: https://pentest-tools.com/docs/api/v2
- **OpenAPI Schema**: https://app.pentest-tools.com/api-schema.yml

### Authentication
```python
headers = {
    "Authorization": f"Bearer {API_KEY}",
    "Content-Type": "application/json"
}
```

## Available Pentest Tools

| Tool ID | Tool Name | Description |
|---------|-----------|-------------|
| 20 | SUBDOMAIN_FINDER | Find subdomains of a target domain |
| 70 | TCP_PORT_SCANNER | Scan TCP ports on target |
| 80 | UDP_PORT_SCANNER | Scan UDP ports on target |
| 90 | URL_FUZZER | Fuzz URLs to discover hidden paths/files |
| 160 | FIND_VHOSTS | Discover virtual hosts on a server |
| 170 | WEBSITE_SCANNER | Comprehensive web vulnerability scanner |
| 260 | SHARE_POINT_SCANNER | SharePoint-specific vulnerability scanner |
| 270 | WORDPRESS_SCANNER | WordPress vulnerability scanner |
| 280 | DRUPAL_SCANNER | Drupal CMS vulnerability scanner |
| 290 | JOOMLA_SCANNER | Joomla CMS vulnerability scanner |
| 310 | WEBSITE_RECON | Website reconnaissance tool |
| 350 | NETWORK_SCANNER | Network infrastructure scanner |
| 390 | DOMAIN_FINDER | Find related domains |
| 400 | PASSWORD_AUDITOR | Audit password strength |
| 450 | SSL_SCANNER | SSL/TLS configuration scanner |
| 490 | SNIPER | Precision vulnerability scanner |
| 500 | WAF_DETECTOR | Web Application Firewall detector |
| 510 | API_SCANNER | REST API vulnerability scanner |
| 520 | CLOUD_SCANNER | Cloud infrastructure scanner |
| 540 | KUBERNETES_SCANNER | Kubernetes security scanner |

## Core API Endpoints

### 1. Targets Management
```python
# Get all targets
GET /targets

# Create a new target
POST /targets
{
    "name": "https://example.com",
    "description": "Production website",
    "workspace_id": 123  # optional
}

# Get specific target
GET /targets/{id}

# Delete target
DELETE /targets/{id}
```

### 2. Workspaces
```python
# Get all workspaces
GET /workspaces

# Create workspace
POST /workspaces
{
    "name": "Project Alpha",
    "description": "Client project workspace"
}

# Get workspace details
GET /workspaces/{id}

# Update workspace
PUT /workspaces/{id}

# Delete workspace
DELETE /workspaces/{id}
```

### 3. Scans Management
```python
# Get all scans
GET /scans?workspace_id=123&target_id=456

# Start a new scan
POST /scans
{
    "tool_id": 170,  # Website Scanner
    "target_name": "https://example.com",
    # OR "target_id": 123,
    "tool_params": {
        "scan_type": "full_new",
        "follow_redirects": true
    },
    "workspace_id": 123  # optional
}

# Get scan status
GET /scans/{id}

# Get scan output
GET /scans/{id}/output

# Get raw scan output
GET /scans/{id}/raw

# Stop running scan
POST /scans/{id}/stop

# Delete scan
DELETE /scans/{id}
```

### 4. HTTP Request Loggers
```python
# Get all loggers
GET /http_loggers

# Create logger
POST /http_loggers
{
    "label": "mypentest"
}

# Get logger info
GET /http_loggers/{id}

# Get logged data
GET /http_loggers/{id}/data

# Clear logger data
DELETE /http_loggers/{id}/data

# Delete logger
DELETE /http_loggers/{id}
```

### 5. Findings & Reports
```python
# Get all findings
GET /findings

# Get specific finding
GET /findings/{id}

# Get all reports
GET /reports

# Create report
POST /reports
{
    "name": "Security Assessment Report",
    "workspace_id": 123,
    "finding_ids": [1, 2, 3]
}

# Get report info
GET /reports/{id}

# Download report
GET /reports/{id}/download

# Delete report
DELETE /reports/{id}
```

### 6. Other Resources
```python
# Get finding templates
GET /public/finding_templates

# Get wordlists
GET /wordlists

# Get wordlist contents
GET /wordlists/{id}/contents

# Get VPN profiles
GET /vpn_profiles
```

## Tool-Specific Parameters

### Website Scanner (tool_id: 170)
```python
tool_params = {
    "scan_type": "light|full_new",  # Scan depth
    "follow_redirects": true,
    "user_agent": "custom user agent",
    "authentication": {
        "type": "basic|form|custom",
        "username": "user",
        "password": "pass"
    }
}
```

### API Scanner (tool_id: 510)
```python
tool_params = {
    "spec_url": "https://api.example.com/openapi.json",
    "authentication_headers": {
        "Authorization": "Bearer token"
    }
}
```

### Port Scanner (tool_id: 70)
```python
tool_params = {
    "port_range": "1-65535",
    "scan_speed": "fast|normal|slow"
}
```

## Response Format

### Successful Response
```json
{
    "status": "success",
    "data": {
        // Response data
    }
}
```

### Error Response
```json
{
    "status": "error",
    "message": "Error description",
    "errors": {
        "field": ["error details"]
    }
}
```

### Scan Status Response
```json
{
    "data": {
        "id": 12345,
        "status_name": "running|finished|stopped|error",
        "progress": 75,
        "created_at": "2025-06-01T10:00:00Z",
        "finished_at": null
    }
}
```

## Integration Tips

1. **Rate Limiting**: Be mindful of API rate limits
2. **Polling**: When checking scan status, use reasonable intervals (2-5 seconds)
3. **Error Handling**: Always check response status and handle errors gracefully
4. **Workspace Organization**: Use workspaces to organize scans by project/client
5. **VPN Support**: Use VPN profiles for internal network scanning
6. **Authentication**: Many tools support authenticated scanning
7. **Webhooks**: Use callbacks for scan completion notifications

## Sample Workflow

```python
# 1. Create workspace
workspace = create_workspace("New Project")

# 2. Add target
target = add_target("https://example.com", workspace_id=workspace['id'])

# 3. Start scan
scan = start_scan(
    target_id=target['id'],
    tool_id=Tool.WEBSITE_SCANNER,
    tool_params={"scan_type": "full_new"}
)

# 4. Monitor scan
while True:
    status = get_scan_status(scan['id'])
    if status['status_name'] == 'finished':
        break
    time.sleep(5)

# 5. Get results
results = get_output(scan['id'])

# 6. Generate report
report = create_report(
    name="Security Assessment",
    workspace_id=workspace['id'],
    scan_ids=[scan['id']]
)
```
